<%- include head.ejs %>
<div id="chart"></div>
<select id="chartType">
  <option value="pie">pie</option>
  <option value="line">line</option>
  <option value="bar">bar</option>

</select>
<br>
<input id="startDate" type="date" name="" value="">
<input id="stopDate" type="date" name="" value="">
<button type="button" onclick="LoadChart()" name="button" class="btn btn-info"> Load</button>
<!-- Load c3.css -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.css" rel="stylesheet">

<!-- Load d3.js and c3.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.js" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js" charset="utf-8"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.js"></script>

<script>

function LoadChart(){
  var chartType=$('#chartType :selected').text();
  console.log(chartType);
  var  startDate= $('#startDate').val();
  var  stopDate=  $('#stopDate').val();
  var data={
    "startDate":startDate,
    "stopDate":stopDate
  };
  $.ajax({
  type: 'POST',
  data: JSON.stringify(data),
  contentType: 'application/json',
  url: 'http://127.0.0.1:8000/QuanLy/LoadChart',
  success: function(results) {
        console.log('success');
        console.log(JSON.stringify(results));
        var columns=[];
        for(var i=0;i<results.length;++i){
          var temp=[results[i].ProductName,results[i].number];
          columns.push(temp);
        }
        console.log(chartType);
        var chart = c3.generate({
            bindto: '#chart',
            data: {
              columns:columns,
              type: chartType
            }
        });
    }
  });
}


  var results = JSON.parse('<%-JSON.stringify(results)%>');
  console.log(results);
  var columns=[];
  for(var i=0;i<results.length;++i){
    var temp=[results[i].ProductName,results[i].number];
    columns.push(temp);
  }
  console.log(columns);
  var chart = c3.generate({
      bindto: '#chart',
      data: {
        columns:columns,
        type: 'pie'
      }
  });
</script>
